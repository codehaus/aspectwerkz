<?xml version="1.0"?>

<aspectwerkz>

    <introduction-def name="persistable" interface="org.codehaus.aspectwerkz.extension.persistence.Persistable"/>

    <advice-def name="makePersistent"
        class="org.codehaus.aspectwerkz.extension.persistence.DirtyFieldCheckAdvice"
        deployment-model="perJVM"
        attribute="persistent"/>

    <aspect name="Persistence">
        <introduce class="examples.transparentpersistence.Counter">
            <introduction-ref name="persistable"/>
        </introduce>

        <pointcut name="persistentFields" type="setField" pattern="* examples.transparentpersistence.Counter.*"/>

        <advise pointcut="persistentFields">
            <advice-ref name="makePersistent"/>
        </advise>

    </aspect>



</aspectwerkz>